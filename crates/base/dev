if [[ -z "$BASE_USER" ]]; then
	log_error "!!! Required variable BASE_USER unset; aborting !!!"
	exit 1
fi

if [[ -z "$BASE_HOME" ]]; then
	log_error "!!! Required variable BASE_HOME unset; aborting !!!"
	exit 1
fi

log_info "\n~~~ Verifying Git ~~~\n"

GIT=$(which git)
if [[ $? -ne 0 ]]; then
	log_error "!!! No Git detected; check and retry !!!"
	exit 1
fi
GITVER=$(git --version)
log_info "    - Found Git, $GITVER"

if [[ -z "$GIT_USER" ]]; then
    GIT_USER="Michael Skelton"
fi

if [[ -z "$GIT_EMAIL" ]]; then
    GIT_USER="skelton.michael@gmail.com"
fi

log_info "    - Setting .gitconfig"
/bin/sudo -u $BASE_USER $GIT config --global --add user.name "$GIT_USER"
/bin/sudo -u $BASE_USER $GIT config --global --add user.email "$GIT_EMAIL"

if [[ ! -d $BASE_HOME/Code ]]; then
	log_info "\n~~~ Creating ~/Code directory ~~~\n"
	/bin/sudo -u $BASE_USER mkdir -p $BASE_HOME/Code
fi

log_info "~~~ Installing ViM config ~~~\n"

[[ ! -d $BASE_HOME/.vim ]] && /bin/sudo -u $BASE_USER mkdir $BASE_HOME/.vim

/bin/sudo -u $BASE_USER cp modules/vim-conf/conf/.vimrc $BASE_HOME
/bin/sudo -u $BASE_USER cp -R modules/vim-conf/conf $BASE_HOME/.vim/
/bin/sudo -u $BASE_USER cp -R modules/vim-conf/colors $BASE_HOME/.vim/

log_info "~~~ Installing tmux config ~~~\n"

/bin/sudo -u $BASE_USER cp modules/tmux-conf/.tmux.conf $BASE_HOME

